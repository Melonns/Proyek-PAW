CREATE DATABASE IF NOT EXISTS mua_attire;
USE mua_attire;

-- Tabel user login (optional)
CREATE TABLE IF NOT EXISTS authentication (
  id INT AUTO_INCREMENT PRIMARY KEY,
  username VARCHAR(100) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL
);

-- Tabel transaksi utama
CREATE TABLE transaksi (
  id INT AUTO_INCREMENT PRIMARY KEY,
  kode_transaksi VARCHAR(50) NOT NULL UNIQUE,
  tanggal DATE NOT NULL,
  klien VARCHAR(100) NOT NULL,
  status ENUM('Selesai', 'Pending', 'Batal') DEFAULT 'Selesai'
);

-- Tabel daftar jenis layanan
CREATE TABLE IF NOT EXISTS layanan (
  id INT AUTO_INCREMENT PRIMARY KEY,
  nama VARCHAR(50) NOT NULL
);

-- Tabel detail dari setiap layanan per transaksi
CREATE TABLE detail_transaksi (
  id INT AUTO_INCREMENT PRIMARY KEY,
  transaksi_id INT NOT NULL,
  layanan_id INT NOT NULL,
  jumlah INT NOT NULL,
  harga INT NOT NULL,
  keterangan TEXT,
  FOREIGN KEY (transaksi_id) REFERENCES transaksi(id) ON DELETE CASCADE,
  FOREIGN KEY (layanan_id) REFERENCES layanan(id) ON DELETE CASCADE
);

-- Tabel pengeluaran yang terkait dengan transaksi
CREATE TABLE pengeluaran (
  id INT AUTO_INCREMENT PRIMARY KEY,
  transaksi_id INT NOT NULL,
  tanggal DATE NOT NULL,
  keterangan TEXT NOT NULL,
  jumlah INT NOT NULL,
  kategori VARCHAR(100),
  FOREIGN KEY (transaksi_id) REFERENCES transaksi(id) ON DELETE CASCADE
);
